
# templates/dashboard.html
<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <style>
        .subject { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }
        .schedule-item { background: #f0f0f0; padding: 5px; margin: 5px 0; }
        .completed { background: #d4edda; }
        .partial { background: #fff3cd; }
    </style>
</head>
<body>
    <h1>Welcome, {{ user['username'] }}</h1>
    <a href="/logout">Logout</a>
    
<h2>Your Subjects</h2>

{% for subject in subjects %}
<div class="subject">

    <h3>{{ subject.subject_name }}</h3>
    <p>Exam: {{ subject.exam_date or 'No date set' }}</p>
    <p>Self Rating: {{ subject.self_rating }}/10</p>

    <!-- EDIT & DELETE SUBJECT -->
    <div class="subject-actions">
        <a href="/edit_subject/{{ subject.subject_id }}" class="btn-edit">Edit</a>

        <form method="POST" action="/delete_subject" style="display:inline;">
            <input type="hidden" name="subject_id" value="{{ subject.subject_id }}">
            <button type="submit" class="btn-delete"
                onclick="return confirm('Are you sure you want to delete this subject?')">
                Delete
            </button>
        </form>
    </div>

    <!-- ADD TOPIC FORM -->
    <form method="POST" action="/add_topic">
        <input type="hidden" name="subject_id" value="{{ subject.subject_id }}">

        <input type="text" name="topic_name" placeholder="New Topic" required>

        <select name="difficulty">
            <option value="easy">Easy</option>
            <option value="medium">Medium</option>
            <option value="hard">Hard</option>
        </select>

        <select name="priority">
            <option value="1">High</option>
            <option value="2">Medium</option>
            <option value="3">Low</option>
        </select>

        <button type="submit">Add Topic</button>
    </form>

</div>
{% endfor %}


    
    <h2>Add New Subject</h2>
    <form method="POST" action="/add_subject">
        <input type="text" name="subject_name" placeholder="Subject Name" required>
        <input type="date" name="exam_date">
        <input type="number" name="self_rating" min="1" max="10" placeholder="Self Rating (1-10)">
        <button type="submit">Add Subject</button>
    </form>
    
    <h2>AI Features</h2>
    <a href="/generate_schedule"><button>Generate AI Schedule</button></a>
    
    <h3>Mood Tracker</h3>
    <form id="moodForm">
        Mood (1-5): <input type="number" name="mood_score" min="1" max="5" value="3"><br>
        Energy (1-5): <input type="number" name="energy_level" min="1" max="5" value="3"><br>
        Stress (1-5): <input type="number" name="stress_level" min="1" max="5" value="3"><br>
        <button type="button" onclick="submitMood()">Log Mood</button>
    </form>
    
    <h3>AI Recommendations</h3>
    <button onclick="getRecommendations()">Get AI Suggestions</button>
    <div id="recommendations"></div>
    
    <script>
    function submitMood() {
        const form = document.getElementById('moodForm');
        const formData = new FormData(form);
        
        fetch('/log_mood', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            alert('Mood logged!');
            if (data.adaptations && data.adaptations.length > 0) {
                alert('AI suggests: ' + data.adaptations[0].reason);
            }
        });
    }
    
    function getRecommendations() {
        fetch('/get_ai_recommendations')
        .then(response => response.json())
        .then(data => {
            const container = document.getElementById('recommendations');
            container.innerHTML = '';
            
            data.recommendations.forEach(rec => {
                const div = document.createElement('div');
                div.innerHTML = `<strong>${rec.type}:</strong> ${rec.message}`;
                container.appendChild(div);
            });
        });
    }
    </script>
</body>
</html>
